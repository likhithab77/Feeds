package com.BITest;

import com.rabbitmq.client.*;
import java.io.IOException;


public class Rec {
	private static final String QUEUE_NAME = "camelotQueue";
    public static void main(String[] args) throws Exception{
	  ConnectionFactory factory = new ConnectionFactory();
	  //set connection info
	  
	  factory.setHost("10.202.188.134"); 
	  factory.setPort(31609);
	  factory.setUsername("lotos10");
	  factory.setPassword("lotos10");
	  //create the connection
	  
      Connection connection = factory.newConnection();
       
      // create the channel
       final Channel channel = connection.createChannel();

      System.out.println("Connection made successfully");
      channel.queueDeclare(QUEUE_NAME, true, false, false, null);
      System.out.println(" [*] Consumer : waiting for messages. To exit press CTRL+C");

	Consumer consumer = new DefaultConsumer(channel) {
	  @Override
	  public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body)
	      throws IOException {
	    String message = new String(body, "UTF-8");
	    System.out.println(" [x] Received '" + message + "'");
	    long deliveryTag = envelope.getDeliveryTag();
	    channel.basicAck(deliveryTag, false);
	  }
	};
	channel.basicConsume(QUEUE_NAME, true, consumer);
	
	    }
}