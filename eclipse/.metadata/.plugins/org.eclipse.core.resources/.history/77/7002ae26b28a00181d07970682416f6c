package com.BITest;

import com.rabbitmq.client.*;
import java.io.IOException;


public class Receiver {
	private static final String QUEUE_NAME = "camelotQueue";
public static void main(String[] args) throws Exception{
	  ConnectionFactory factory = new ConnectionFactory();
	  //set connection info
	  
	  factory.setHost("10.100.146.95:30405"); 
	  factory.setUsername("lotos10");
	  factory.setPassword("lotos10");
	  //create the connection
	  
      Connection connection = factory.newConnection();
       
      // create the channel
      Channel channel = connection.createChannel();


      channel.queueDeclare(QUEUE_NAME, false, false, false, null);
      System.out.println(" [*] Consumer : waiting for messages. To exit press CTRL+C");

	Consumer consumer = new DefaultConsumer(channel) {
	  @Override
	  public void handleDelivery(String consumerTag, Envelope envelope, AMQP.BasicProperties properties, byte[] body)
	      throws IOException {
	    String message = new String(body, "UTF-8");
	    System.out.println(" [x] Received '" + message + "'");
	  }
	};
	channel.basicConsume(QUEUE_NAME, true, consumer);
	}
	}